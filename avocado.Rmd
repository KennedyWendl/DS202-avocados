---
title: "avocado"
author: "Andrew Chen"
date: "2023-05-01"
output: html_document
---

Team Members: Andrew Chen, Vrinda Vegiraju, Kennedy Wendl

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
```

```{r}
avo = read.csv("avocado.csv", header = TRUE)
```

We will be using the avocados data set from https://www.kaggle.com/datasets/neuromusic/avocado-prices. 
The data was collected by the Hass Avocado Board website. 
There are 14 variables in this data set. X is the index. 
Date is the date of when the data was observed. 
AveragePrice is the average price of one avocado. 
Total_Volume is the total number of avocados sold. 
4046,4225,4770 are the PLU codes, which is the weight of the avocado. 
4046 is 3-5 oz, 4225 is 8-10 oz, 4770 is 10-15 oz. 
Total_Bags is the total number of bags sold. 
Small_Bags is the number of small bags sold. 
Large_Bags is the number of large bags sold. 
XLarge_Bags is the number of extra large bags sold. 
Type is the type of avocado (conventional or organic). 
Year is the year that the data was observed. 
Region is the location of where the data was observed.

The data is already cleaned from what we can see.


Scatter
```{r}
#Kennedy
avo_scatter = avo
```

Line
```{r}
#Vrinda
avo_line = avo
```

Time Series
```{r}
#Time Series
avo_time = avo
avo_time2 <- avo_time %>%
  mutate(Date = as.Date(Date)) %>%
  group_by(year = lubridate::year(Date), month = lubridate::month(Date)) %>%
  summarise(ave_price = mean(AveragePrice))

#Most expensive
avo_time_most <- avo_time2 %>% slice_max(ave_price)

#Least expensive
avo_time_least <- avo_time2 %>% slice_min(ave_price)

#Make Graph
ggplot(data = avo_time2, aes(x = as.Date(paste(year, month, "01", sep = "-")), y = ave_price)) +
  geom_line() +
  geom_point(data = avo_time_most, aes(x = as.Date(paste(year, month, "01", sep = "-")), 
                                       y = ave_price), size = 2, color = "red") +
  geom_text(data = avo_time_most, aes(label=round(ave_price, 2),
                                      x = as.Date(paste(year, month, "01", sep = "-")),
                                      y = ave_price), vjust = -1) +
  geom_point(data = avo_time_least, aes(x = as.Date(paste(year, month, "01", sep = "-")), 
                                       y = ave_price), size = 2, color = "blue") +
  geom_text(data = avo_time_least, aes(label=round(ave_price, 2),
                                      x = as.Date(paste(year, month, "01", sep = "-")),
                                      y = ave_price), vjust = 2) +
  labs(title = "Average Price of Avocados", x = "Year", y = "Average Price") +
  ylim(1, 2) 
  
```
The average max price of avocados is going up, while the min price is about the same. 
In 2015, the most expensive was \$1.45. In 2016, it was \$1.56. In 2017, it was \$1.84.

Box
```{r}
#Kennedy
avo_box = avo
```

Bar
```{r}
#Vrinda
avo_bar = avo
```

Histogram
```{r}
avo_hist = avo
avo_hist2 <- subset(avo_hist, !(region %in% c("Midsouth", "Northeast", "SouthCentral",
                                              "Southeast", "West", "TotalUS" )))

ggplot(data = avo_hist2, aes(x = Total_Volume)) +
  geom_histogram(bins = 50) +
  scale_x_continuous(limits = c(0, 6500000), labels = scales::comma_format()) +
  coord_cartesian(ylim = c(0, 2500)) +
  facet_wrap(~type)

```


Mosaic
```{r}
avo_mos = avo
```

Map
```{r}
avo_map = avo
```

